<% players = Player.all.order(:name) %>
<%= form_with model: match, html: { novalidate: true } do |f| %>
  <div class="flex flex-col gap-2 py-4">
    <%= render "match_header", match: match %>
    <div class="grid grid-cols-2 gap-2 w-full">
      <div class="flex flex-col gap-2">
        <h2 class="font-semibold">Team A</h2>

        <%= f.fields_for :team_1_attributes do |team_1| %>
          <%= team_1.select :player_1_id,
            options_from_collection_for_select(players, :id, :name, match.team_1.player_1_id) %>
          <%= team_1.select :player_2_id,
            options_from_collection_for_select(players, :id, :name, match.team_1.player_2_id) %>
        <% end %>
      </div>
      <div class="flex flex-col gap-2">
        <h2 class="font-semibold">Team B</h2>

        <%= f.fields_for :team_2_attributes do |team_1| %>
          <%= team_1.select :player_1_id,
            options_from_collection_for_select(players, :id, :name, match.team_2.player_1_id) %>
          <%= team_1.select :player_2_id,
            options_from_collection_for_select(players, :id, :name, match.team_2.player_2_id) %>
        <% end %>
      </div>
    </div>

    <div class="grid grid-cols-2 gap-2 w-full">
      <div class="flex flex-col gap-2">
        <h2 class="font-semibold">Lugar</h2>

        <%= f.select :location_id,
          options_from_collection_for_select(Location.all, :id, :name) %>
      </div>
      <div class="flex flex-col gap-2">
        <h2 class="font-semibold">Fecha</h2>

        <%= f.datetime_field :played_at %>
      </div>
    </div>

    <div class="flex flex-col gap-2">
      <h2 class="font-semibold">Sets</h2>

      <%= f.fields_for :score_sets do |score_set| %>
        <div class="grid grid-cols-4 gap-2 w-full">
          <span class="text-gray-400 text-center my-auto"><%= score_set.object.persisted? ? "##{score_set.object.rank}" : '+' %></span>
          <%= score_set.number_field :score_1 %>
          <%= score_set.number_field :score_2 %>
          <div class="flex flex-row justify-center my-auto">
            <%= score_set.check_box :_destroy, class: "hidden peer" %>
            <%= score_set.label :_destroy, class: "peer-checked:text-red-500" do %>
              <%= inline_svg_tag "icons/trash.svg", class: "w-6 h-6" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <div class="grid grid-cols-2 gap-2">
      <%= link_to "Cancelar", :back, class: "btn btn-secondary" %>
      <%= f.submit "Guardar", class: "btn btn-primary" %>
    </div>
  </div>
<% end %>
